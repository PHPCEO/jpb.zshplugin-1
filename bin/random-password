#!/bin/bash
#
# Generate a random password. If no argument, assume 32 characters

PASSWORD_SIZE=32
if [ ! -z "$1" ] ; then
  PASSWORD_SIZE="$1"
fi

# sha512 outputs 128 characters
if [ ${PASSWORD_SIZE} -gt 128 ]; then
  PASSWORD_SIZE=128
fi

od -N${PASSWORD_SIZE} -An -i < /dev/urandom | # Get N random bytes from kernel
openssl sha512 /dev/stdin |                   # Convert into password-friendly format
awk '{print $2}' |                            # strip off the sha
head -c ${PASSWORD_SIZE} ; echo               # Trim to requested password size
